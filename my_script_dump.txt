import glob
for file in glob.glob("./output/*.csv"):
    print(file)
import csv
for file in glob.glob("./output/*.csv"):
    with open(file) as f:
        reader = csv.reader(f)
        data = next(iter(reader))
import csv
for file in glob.glob("./output/*.csv"):
    with open(file) as f:
        reader = csv.reader(f)
        data = next(iter(reader))
        print(data)
import csv
for file in glob.glob("./output/*.csv"):
    with open(file) as f:
        reader = csv.reader(f)
        data = next(iter(reader))[1]+".tar.gz"
    print(data)
    break
import os

def file_exists_recursive(filename: str, root_dir: str = ".") -> bool:
    """
    Check if a file with the given name exists anywhere under the specified directory.

    Parameters:
        filename (str): The name of the file to search for (not a path).
        root_dir (str): The directory to start searching from. Defaults to current directory.

    Returns:
        bool: True if the file is found, False otherwise.
    """
    for dirpath, _, filenames in os.walk(root_dir):
        if filename in filenames:
            return True
    return False
import csv
for file in glob.glob("./output/*.csv"):
    with open(file) as f:
        reader = csv.reader(f)
        data = next(iter(reader))[1]+".tar.gz"
    exists = file_exists_recursive(data)
    print(data, exists)
    break
import pandas as pd
df = pd.read_csv("extraction_biblissima_20250410.csv", delimiter=";")["manifest_url"]
df = alternate_by_domain(df).tolist()
df = [
        uri.replace("https://gallica.bnf.fr/iiif/ark:/12148/", "https://openapi.bnf.fr/iiif/presentation/v3/ark:/12148/")
        for uri in df
]
df = pd.read_csv("extraction_biblissima_20250410.csv", delimiter=";")["manifest_url"]
df = [
        uri.replace("https://gallica.bnf.fr/iiif/ark:/12148/", "https://openapi.bnf.fr/iiif/presentation/v3/ark:/12148/")
        for uri in df
]
df
import csv
for file in glob.glob("./output/*.csv"):
    with open(file) as f:
        reader = csv.reader(f)
        data = next(iter(reader))[1]+".tar.gz"
    exists = file_exists_recursive(data)
    print(data, exists)
    break
import cases
downloaded = []
for uri in df:
    name = f"output/{cases.to_kebab(name)}.csv"
    if os.path.exists(name)
downloaded = []
for uri in df:
    name = f"output/{cases.to_kebab(name)}.csv"
    if os.path.exists(name):
        with open(file) as f:
            reader = csv.reader(f)
            data = next(iter(reader))[1]+".tar.gz"
            exists = file_exists_recursive(data)
        print(uri, data, exists)
downloaded = []
for uri in df:
    name = f"output/{cases.to_kebab(uri)}.csv"
    if os.path.exists(name):
        with open(file) as f:
            reader = csv.reader(f)
            data = next(iter(reader))[1]+".tar.gz"
            exists = file_exists_recursive(data)
        print(uri, data, exists)
%history -f my_script_dump.txt
